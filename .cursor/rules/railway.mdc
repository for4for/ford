---
alwaysApply: false
description: Railway deployment ve veritabanÄ± baÄŸlantÄ± bilgileri
globs:
---

# ğŸš‚ Railway Deployment Bilgileri

## Proje

| Bilgi | DeÄŸer |
|-------|-------|
| Proje AdÄ± | `ford-multi-brand` |
| Environment | `production` |
| Project ID | `b018c921-aa2f-4329-b00d-6fb11d5c69f0` |

## Servisler

| Servis | URL |
|--------|-----|
| Backend | `backend-production-657f.up.railway.app` |
| Frontend | `frontend-production-4341.up.railway.app` |
| PostgreSQL (internal) | `postgres.railway.internal:5432` |
| PostgreSQL (public) | `tramway.proxy.rlwy.net:19597` |

## Railway CLI KullanÄ±mÄ±

Railway CLI proje ile `/Users/taner/for/dummies/ford` dizinine linklidir.

```bash
# Proje durumu
cd /Users/taner/for/dummies/ford && railway status

# Servis variable'larÄ±nÄ± listele
railway variables                          # Aktif servisin (backend) variable'larÄ±
railway variables --service Postgres       # PostgreSQL variable'larÄ±
railway variables --service backend        # Backend variable'larÄ±
railway variables --service frontend       # Frontend variable'larÄ±
```

## Log Alma

> âš ï¸ `railway logs` streaming modda pager sorunu yaÅŸatÄ±r. **Her zaman `--lines N` parametresi kullanÄ±lmalÄ±dÄ±r** (streaming yerine geÃ§miÅŸ loglarÄ± Ã§eker).

```bash
# Son 50 deploy logu (backend)
cd /Users/taner/for/dummies/ford && railway logs --service backend --lines 50

# Son 50 deploy logu (frontend)
railway logs --service frontend --lines 50

# Build loglarÄ± (son deploy)
railway logs --service frontend --build --lines 50
railway logs --service backend --build --lines 50

# Belirli bir deployment'Ä±n loglarÄ±
railway logs --service backend <DEPLOYMENT_ID> --lines 100

# Sadece hata loglarÄ±
railway logs --service backend --lines 30 --filter "@level:error"

# Sadece uyarÄ± loglarÄ±
railway logs --service backend --lines 30 --filter "@level:warn"

# JSON formatÄ±nda log (parse etmek iÃ§in)
railway logs --service backend --lines 20 --json
```

### Log Parametreleri

| Parametre | AÃ§Ä±klama |
|-----------|----------|
| `--service <NAME>` | Servis adÄ±: `backend`, `frontend`, `Postgres` |
| `--lines N` / `-n N` | Son N satÄ±r log (streaming kapatÄ±r, **her zaman kullan**) |
| `--build` / `-b` | Build loglarÄ±nÄ± gÃ¶ster (deploy yerine) |
| `--deployment` / `-d` | Deployment loglarÄ±nÄ± gÃ¶ster |
| `--filter "<QUERY>"` | Log filtreleme: `@level:error`, `@level:warn`, metin arama |
| `--json` | JSON formatÄ±nda Ã§Ä±ktÄ± |

## PostgreSQL BaÄŸlantÄ±sÄ± (DÄ±ÅŸarÄ±dan / Lokal)

Railway PostgreSQL'e lokal makineden baÄŸlanmak iÃ§in **public proxy URL** kullanÄ±lÄ±r:

```bash
# Direkt psql ile baÄŸlanma
PGPASSWORD=rgQTouyXQGCSTpQUngbnoSzKcUrINRdo psql \
  -h tramway.proxy.rlwy.net \
  -p 19597 \
  -U postgres \
  -d railway

# Tek sorgu Ã§alÄ±ÅŸtÄ±rma
PGPASSWORD=rgQTouyXQGCSTpQUngbnoSzKcUrINRdo psql \
  -h tramway.proxy.rlwy.net \
  -p 19597 \
  -U postgres \
  -d railway \
  -c "SELECT * FROM django_migrations ORDER BY applied DESC LIMIT 10;"
```

### BaÄŸlantÄ± Parametreleri

| Parametre | DeÄŸer |
|-----------|-------|
| Host (public) | `tramway.proxy.rlwy.net` |
| Port (public) | `19597` |
| Host (internal) | `postgres.railway.internal` |
| Port (internal) | `5432` |
| User | `postgres` |
| Password | `rgQTouyXQGCSTpQUngbnoSzKcUrINRdo` |
| Database | `railway` |

> âš ï¸ **Internal URL** (`postgres.railway.internal`) sadece Railway aÄŸÄ± iÃ§inden eriÅŸilebilir. Lokal makineden baÄŸlanÄ±rken **public proxy** (`tramway.proxy.rlwy.net:19597`) kullanÄ±lmalÄ±dÄ±r.

## Lokal Docker PostgreSQL BaÄŸlantÄ±sÄ±

Lokal geliÅŸtirme ortamÄ±ndaki veritabanÄ± (`docker-compose.yml`):

```bash
# Ford DB
PGPASSWORD=postgres psql -h localhost -p 5484 -U postgres -d ford_db

# Tofas DB
PGPASSWORD=postgres psql -h localhost -p 5484 -U postgres -d tofas_db
```

| Parametre | DeÄŸer |
|-----------|-------|
| Host | `localhost` |
| Port | `5484` |
| User | `postgres` |
| Password | `postgres` |
| Ford DB | `ford_db` |
| Tofas DB | `tofas_db` |

## Migration Kontrolleri

```bash
# Lokal - Ford DB
PGPASSWORD=postgres psql -h localhost -p 5484 -U postgres -d ford_db \
  -c "SELECT app, name, applied FROM django_migrations ORDER BY applied DESC LIMIT 10;"

# Lokal - Tofas DB
PGPASSWORD=postgres psql -h localhost -p 5484 -U postgres -d tofas_db \
  -c "SELECT app, name, applied FROM django_migrations ORDER BY applied DESC LIMIT 10;"

# Railway (Production)
PGPASSWORD=rgQTouyXQGCSTpQUngbnoSzKcUrINRdo psql \
  -h tramway.proxy.rlwy.net -p 19597 -U postgres -d railway \
  -c "SELECT app, name, applied FROM django_migrations ORDER BY applied DESC LIMIT 10;"
```

## Lokal Migration Ã‡alÄ±ÅŸtÄ±rma (Docker)

```bash
# Ford DB (default)
docker exec ford_backend python manage.py migrate

# Tofas DB
docker exec ford_backend python manage.py migrate --database=tofas
```

## Git Push & Deploy

Railway deploy'u tetiklemek iÃ§in:

```bash
git push origin multi-brand
```

Railway `multi-brand` branch'ini izliyor. Push her zaman bu branch'e yapÄ±lmalÄ±dÄ±r. Deploy otomatik tetiklenir.
